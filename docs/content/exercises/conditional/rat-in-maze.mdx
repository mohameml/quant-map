---
id: "rat-in-maze"
title: "Rat in a Maze"
difficulty: "Hard"
patterns: ["conditional"]
tags:
    [
        "probability",
        "expectation",
        "conditional-expectation",
        "markov-process",
        "recursive",
    ]
---

## Exercise

A rat is in a maze, facing two doors. At each attempt, it chooses:

- the **first door** with probability $p$, and
- the **second door** with probability $1 - p$.

The consequences are:

- If it chooses the **first door**, it immediately returns to its starting point after **one minute**.
- If it chooses the **second door**, it moves to an intermediate point in **one minute**, then:
    - it **turns back** with probability $q$, which takes another **one minute**, or
    - it **leaves the maze permanently** with probability $1 - q$, after **one minute**.

All of the rat's choices are made independently of each other.

Let $T$ denote the **total time spent by the rat in the maze**.

**Questions:**

1. Determine the expectation $\mathbb{E}[T]$.
2. Determine the probability distribution of $T$.

## Hint

Use conditional expectation. If the rat chooses door 1, it returns to the start after 1 minute. If it chooses door 2, consider what happens at the intermediate point.

## Hint

Set up a recursive equation for $\mathbb{E}[T]$ by conditioning on the first door chosen. Use the law of total expectation.

## Hint

For the distribution of $T$, note that $T$ takes values in $\{2, 3, 4, \dots\}$. The rat exits only when it chooses door 2 and then proceeds forward. Count the number of "failed attempts" before success.

## Solution

Let $T$ denote the total time spent in the maze. The rat chooses:

- door 1 with probability $p$
- door 2 with probability $1 - p$

Let $N$ denote the number of the door chosen at the rat's departure.

**Case 1: Choosing door 1**

If it chooses door 1, it returns to the starting point after 1 minute and restarts in exactly the same situation. Thus:

$$
\mathbb{E}[T \mid N = 1] = 1 + \mathbb{E}[T]
$$

**Case 2: Choosing door 2**

If it chooses door 2, it reaches an intermediate point. From there:

- With probability $1 - q$, it exits the maze after 2 minutes (1 minute forward + 1 minute to exit)
- With probability $q$, it returns to the starting point in 2 minutes (1 minute forward + 1 minute back), and restarts

Thus:

$$
\mathbb{E}[T \mid N = 2] = (1 - q) \cdot 2 + q \cdot (2 + \mathbb{E}[T]) = 2 + q \cdot \mathbb{E}[T]
$$

**Law of total expectation**

We apply the conditional expectation formula:

$$
\mathbb{E}[T] = p \cdot \mathbb{E}[T \mid N = 1] + (1 - p) \cdot \mathbb{E}[T \mid N = 2]
$$

Substituting the expressions obtained:

$$
\mathbb{E}[T] = p(1 + \mathbb{E}[T]) + (1 - p)(2 + q \cdot \mathbb{E}[T])
$$

Expanding:

$$
\mathbb{E}[T] = p + p \cdot \mathbb{E}[T] + 2(1 - p) + q(1 - p) \cdot \mathbb{E}[T]
$$

$$
\mathbb{E}[T] = p + 2(1 - p) + \left(p + q(1 - p)\right) \cdot \mathbb{E}[T]
$$

Rearranging:

$$
\mathbb{E}[T] \cdot \left(1 - \left(p + q(1 - p)\right)\right) = p + 2(1 - p)
$$

$$
\mathbb{E}[T] = \frac{p + 2(1 - p)}{1 - \left(p + q(1 - p)\right)} = \frac{p + 2(1 - p)}{(1 - p)(1 - q)}
$$

**Conclusion**

The expected time spent in the maze is given by:

$$
\boxed{\mathbb{E}[T] = \frac{p + 2(1 - p)}{(1 - p)(1 - q)}}
$$
