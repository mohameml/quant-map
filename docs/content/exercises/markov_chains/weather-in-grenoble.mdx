---
id: "weather-in-grenoble"
title: "Weather in Grenoble"
difficulty: "Hard"
patterns: ["markov-chains"]
tags:
    [
        "probability",
        "markov-chains",
        "transition-matrix",
        "diagonalization",
        "eigenvalues",
        "long-term-behavior",
    ]
---

## Exercise

In Grenoble, the weather evolves according to the following rules:

- If it is sunny one day, it rains the next day with probability $\frac{3}{4}$.
- If it rains one day, it is sunny the next day with probability $\frac{1}{8}$.

These laws have remained unchanged since the year 1200.

**Question:** Calculate the probability that it is sunny on the $n$-th day, without any information about today's weather.

## Hint

Model the weather as a two-state Markov chain. Write down the transition matrix $Q$ and find $Q^n$ to determine the probability after $n$ days.

## Hint

Diagonalize the transition matrix $Q$. Use the fact that for a stochastic matrix, one eigenvalue is always $\lambda_1 = 1$. Find the second eigenvalue using the trace.

## Hint

Express $Q^n = PD^nP^{-1}$ where $D$ is the diagonal matrix of eigenvalues. Calculate $(Q^n)_{0,0}$ to find the probability of sunny weather on day $n$ starting from a sunny day 0.

## Solution

**Markov chain representation**

We model the weather as a two-state chain:

- State $0$: sunny
- State $1$: rainy

The transition matrix is:

$$
Q = \begin{pmatrix}
\frac{1}{4} & \frac{3}{4} \\
\frac{1}{8} & \frac{7}{8}
\end{pmatrix}
$$

**Objective**

Let $p(n) = \mathbb{P}(X_n = 0 \mid X_0 = 0)$ be the probability that it is sunny on day $n$ given that it was sunny on day 0.

We want to calculate:

$$
p(n) = (Q^n)_{0,0}
$$

**Diagonalizing the matrix**

**Eigenvalues**

Since $Q$ is a stochastic matrix (each row sums to 1), we know that $\lambda_1 = 1$ is an eigenvalue.

The trace of $Q$ is:

$$
\mathrm{Tr}(Q) = \frac{1}{4} + \frac{7}{8} = \frac{9}{8}
$$

Since the trace equals the sum of eigenvalues:

$$
\lambda_1 + \lambda_2 = \frac{9}{8} \quad \Rightarrow \quad \lambda_2 = \frac{9}{8} - 1 = \frac{1}{8}
$$

Therefore:

$$
\lambda_1 = 1, \quad \lambda_2 = \frac{1}{8}
$$

**Eigenvectors**

Solving $(Q - \lambda I)v = 0$ for each eigenvalue, we find the associated eigenvectors:

$$
v_1 = \begin{pmatrix} 1 \\ 1 \end{pmatrix}, \quad v_2 = \begin{pmatrix} -6 \\ 1 \end{pmatrix}
$$

The change of basis matrix is:

$$
P = \begin{pmatrix} 1 & -6 \\ 1 & 1 \end{pmatrix}
\quad \text{and} \quad
P^{-1} = \begin{pmatrix} \frac{1}{7} & \frac{6}{7} \\ -\frac{1}{7} & \frac{1}{7} \end{pmatrix}
$$

The associated diagonal matrix is:

$$
D = \begin{pmatrix} 1 & 0 \\ 0 & \frac{1}{8} \end{pmatrix}
$$

Therefore:

$$
Q^n = PD^nP^{-1}
$$

Computing the product:

$$
Q^n = \begin{pmatrix}
\frac{1}{7} + \frac{6}{7}\left( \frac{1}{8} \right)^n & \frac{6}{7} - \frac{6}{7} \left( \frac{1}{8} \right)^n \\
\frac{1}{7} - \frac{1}{7} \left( \frac{1}{8} \right)^n & \frac{6}{7} + \frac{1}{7} \left( \frac{1}{8} \right)^n
\end{pmatrix}
$$

**Final result**

Thus:

$$
\boxed{\mathbb{P}(X_n = 0 \mid X_0 = 0) = p(n) = \frac{1}{7} + \frac{6}{7} \left( \frac{1}{8} \right)^n}
$$

This means that the probability of sunny weather on day $n$, starting from a sunny day, **tends toward $\frac{1}{7}$** as $n \to \infty$.
